if has nix; then
  use flake
fi

shopt -s globstar
watch_file assets/cpp/**/*.cpp
watch_file assets/cpp/**/*.hpp
watch_file plugin/**/*.cpp
watch_file plugin/**/*.hpp
watch_file **/CMakeLists.txt

export CC=clang
export CXX=clang++

cmake -B build -G Ninja -DCMAKE_BUILD_TYPE=Debug -DDISTRIBUTOR=direnv
cmake --build build
export CAELESTIA_LIB_DIR="$PWD/build/lib"
export QML2_IMPORT_PATH="$PWD/build/qml:${QML2_IMPORT_PATH:-}"
