#!/bin/zsh

{{ template "common-misc-env.tmpl" $ }}

# OS Specific
{{- if eq .chezmoi.os "darwin" }}
# Darwin
if [[ -x /opt/homebrew/bin/brew ]]; then
  eval "$(/opt/homebrew/bin/brew shellenv)"
fi
{{- end }}


{{ template "path-setting.tmpl" $ }}

# Snapd desktop directory detection
if [[ -d "/var/lib/snapd/desktop" ]]; then
  # Check if it's already in the path, dealing with edge cases by wrapping in colons
  if [[ ":$XDG_DATA_DIRS:" != *":/var/lib/snapd/desktop:"* ]]; then
    # If XDG_DATA_DIRS is not empty, prepend with a colon
    if [[ -n "$XDG_DATA_DIRS" ]]; then
      XDG_DATA_DIRS="/var/lib/snapd/desktop:$XDG_DATA_DIRS"
    else
      XDG_DATA_DIRS="/var/lib/snapd/desktop"
    fi
    export XDG_DATA_DIRS
  fi
fi

return # This prevents scripts which append their own installers from "working"
{{/* vim: set filetype=zsh: */}}
