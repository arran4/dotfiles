export WATCHFMT="%D %T %n@%l.%M %a"
export WATCH=root

{{if stat (index . "neovimLocation") -}}
	# Make neovim the default editor.
	export EDITOR='{{(index . "neovimLocation")}}'
	export VISUAL={{(index . "neovimLocation")}}
	export ALTERNATE_EDITOR=''
{{- else if stat (index . "vimLocation") -}}
	# Make vim the default editor.
	export EDITOR='{{(index . "vimLocation")}}'
	export VISUAL={{(index . "vimLocation")}}
	export ALTERNATE_EDITOR=''
{{- else -}}
	# No vim found!
{{- end }}

{{ if stat (index . "nvimpagerLocation") -}}
	# Pager IS less
	export PAGER={{(index . "nvimpagerLocation")}}
	export DELTA_PAGER=less
{{ else if stat (index . "vimpagerLocation") -}}
	# Pager IS less
	export PAGER={{(index . "vimpagerLocation")}}
	export DELTA_PAGER=less
{{ else if stat (index . "lessLocation") -}}
	# Pager IS less
	export PAGER={{(index . "lessLocation")}}
{{- else -}}
	# No less found!
{{- end }}

# set variable identifying the chroot you work in (used in the prompt below)
if [ -z "${debian_chroot:-}" ] && [ -r /etc/debian_chroot ]; then
    debian_chroot=$(cat /etc/debian_chroot)
fi

{{- if eq .chezmoi.os "darwin" }}
{{-   if stat "/opt/homebrew/bin/brew" }}
eval "$(/opt/homebrew/bin/brew shellenv)"
{{-   else if stat "/usr/local/bin/brew" }}
eval "$(/usr/local/bin/brew shellenv)"
{{-   end }}
{{- end }}

# Java Home Discovery
# Prioritize manual candidates (SDKMAN, jEnv) over system defaults.
# System defaults: Gentoo (java-config), macOS (/usr/libexec/java_home).

_java_candidates=(
  "$HOME/.sdkman/candidates/java/current"
  "$HOME/.jenv/versions/current"
)

# Only attempt discovery if JAVA_HOME is not already set or invalid
if [ -z "${JAVA_HOME:-}" ] || [ ! -d "${JAVA_HOME}" ]; then
  for cand in "${_java_candidates[@]}"; do
    if [ -d "$cand" ]; then
      export JAVA_HOME="$cand"
      break
    fi
  done
fi

if [ -z "${JAVA_HOME:-}" ]; then
{{- if lookPath "java-config" }}
  if command -v java-config >/dev/null 2>&1; then
    # Gentoo
    _gentoo_java=$(java-config --jdk-home 2>/dev/null)
    if [ -n "$_gentoo_java" ]; then
      export JAVA_HOME="$_gentoo_java"
    fi
  fi
{{- end }}
{{- if stat "/usr/libexec/java_home" }}
  if [ -x /usr/libexec/java_home ]; then
    # macOS
    export JAVA_HOME=$(/usr/libexec/java_home)
  fi
{{- end }}
fi

if [ -n "${JAVA_HOME:-}" ]; then
  # Prepend to PATH if not already present
  case ":$PATH:" in
    *":$JAVA_HOME/bin:"*) ;;
    *) export PATH="$JAVA_HOME/bin:$PATH" ;;
  esac
fi
